# Minsky Doubling Machine k=5

nterm=61, path length=662, y_final=63

## Register Machine

2-counter Minsky register machine that computes `2^6 - 1 = 63`
via 5 iterations of the affine map `y ↦ 2y + 1`.

```
y₀ = 1 → y₁ = 3 → y₂ = 7 → y₃ = 15 → y₄ = 31 → y₅ = 63
```

### Haskell

```haskell
-- k=5 ×2 doubling Minsky machine on repeated-maze
-- 2 registers (x, y), program counter pc
-- Computes y = 2^6 - 1 = 63, then drains to y = 1
-- Initial call: dbl5 (0, 1, 0)
-- Total steps: 662

dbl5 :: (Int, Int, Int) -> (Int, Int, Int)
--       x    y    pc       x    y    pc

-- Start
dbl5 (  _,   1,   0) = dbl5 (  1,   1,   1)     -- entry: x:=1

-- Doubling cycle 1: y:1 → 3
dbl5 (  x,   0,   1) = dbl5 (  x,   1,   2)     -- y=0: bridge, enter P2
dbl5 (  x,   y,   1) = dbl5 (x+2, y-1,   1)     -- y>0: x+=2, y-=1
dbl5 (  1,   y,   2) = dbl5 (  1,   y,   3)     -- x→0: exit to D2
dbl5 (  x,   y,   2) = dbl5 (x-1, y+1,   2)     -- x>1: x-=1, y+=1

-- Doubling cycle 2: y:3 → 7
dbl5 (  x,   0,   3) = dbl5 (  x,   1,   4)
dbl5 (  x,   y,   3) = dbl5 (x+2, y-1,   3)
dbl5 (  1,   y,   4) = dbl5 (  1,   y,   5)
dbl5 (  x,   y,   4) = dbl5 (x-1, y+1,   4)

-- Doubling cycle 3: y:7 → 15
dbl5 (  x,   0,   5) = dbl5 (  x,   1,   6)
dbl5 (  x,   y,   5) = dbl5 (x+2, y-1,   5)
dbl5 (  1,   y,   6) = dbl5 (  1,   y,   7)
dbl5 (  x,   y,   6) = dbl5 (x-1, y+1,   6)

-- Doubling cycle 4: y:15 → 31
dbl5 (  x,   0,   7) = dbl5 (  x,   1,   8)
dbl5 (  x,   y,   7) = dbl5 (x+2, y-1,   7)
dbl5 (  1,   y,   8) = dbl5 (  1,   y,   9)
dbl5 (  x,   y,   8) = dbl5 (x-1, y+1,   8)

-- Doubling cycle 5: y:31 → 63
dbl5 (  x,   0,   9) = dbl5 (  x,   1,  10)
dbl5 (  x,   y,   9) = dbl5 (x+2, y-1,   9)
dbl5 (  1,   y,  10) = dbl5 (  1,   y,  11)
dbl5 (  x,   y,  10) = dbl5 (x-1, y+1,  10)

-- Phase 3: drain y:63 → 0 → 1
dbl5 (  _,   0,  11) =       (  0,   1,  -1)     -- HALT at goal (0,1)
dbl5 (  x,   y,  11) = dbl5 (  x, y-1,  11)     -- y>0: y-=1
```

### Operations

Each doubling cycle consists of two phases:

| Phase | Operation | Per iteration | Zero test |
|---|---|---|---|
| Phase 1 (odd pc) | `while y > 0: x += 2, y -= 1` | x grows by 2, y shrinks by 1 | y = 0 → ny boundary |
| Phase 2 (even pc) | `while x > 1: x -= 1, y += 1` | x shrinks by 1, y grows by 1 | x = 0 → nx boundary |

One cycle effect: `y_new = 1 + 2 * y_old`

Phase 3 drains y back to 1 and halts at the goal state (0, 1).

### Mapping to Maze

| Concept | Register Machine | Repeated Maze |
|---|---|---|
| Register x | INC/DEC x | W→E port (x+1) / E→W port (x-1) |
| Register y | INC/DEC y | S→N port (y+1) / N→S port (y-1) |
| Zero test x=0 | JZ x | nx boundary block (x=0) |
| Zero test y=0 | JZ y | ny boundary block (y=0) |
| Program counter | pc value | Terminal index (dir, idx) |
| Branching | Pattern match on 0 | Different ports in nx/ny vs normal blocks |

### Terminal Index Allocation

```
idx  0    : Start (E-side)
idx  1    : Goal (E-side)
idx  2- 5 : D1 Phase 1 loop (N2→E3, W3→E4, W4→N5, N5→S2)
idx  7-10 : D1 Phase 2 loop (S7→E8, E8→W9, E9→N10, S10→E8)
idx 11    : D1 nx catch output
idx 12-14 : Phase 3 drain (N12→S12, N13 bridge, E14→W1)
idx 15-18 : D2 Phase 1 loop
idx 20-23 : D2 Phase 2 loop
idx 24    : D2 nx catch output
idx 27-30 : D3 Phase 1 loop
idx 32-35 : D3 Phase 2 loop
idx 36    : D3 nx catch output
idx 39-42 : D4 Phase 1 loop
idx 44-47 : D4 Phase 2 loop
idx 48    : D4 nx catch output
idx 51-54 : D5 Phase 1 loop
idx 56-59 : D5 Phase 2 loop
idx 60    : D5 nx catch output
```

### Growth

```
T(k) = O(2^k)  where k = number of doubling cycles
nterm = 12k + 3  (approximately)
T(nterm) = O(2^{nterm/12})  [exponential in nterm]
```

Counter pump crossover at nterm ≈ 253 (k=21).

## Maze

```
normal: W0->N2, N2->E3, W3->E4, W4->N5, N5->S2, S7->E8, E8->W9, E9->N10, S10->E8, W11->N15, N15->E16, W16->E17, W17->N18, N18->S15, S20->E21, E21->W22, E22->N23, S23->E21, W24->N27, N27->E28, W28->E29, W29->N30, N30->S27, S32->E33, E33->W34, E34->N35, S35->E33, W36->N39, N39->E40, W40->E41, W41->N42, N42->S39, S44->E45, E45->W46, E46->N47, S47->E45, W48->N51, N51->E52, W52->E53, W53->N54, N54->S51, S56->E57, E57->W58, E58->N59, S59->E57, W60->N12, N12->S12, S13->E14, E14->W1; nx: E9->E11, E22->E24, E34->E36, E46->E48, E58->E60; ny: N2->N7, N15->N20, N27->N32, N39->N44, N51->N56, N12->N13
```

## Path (662 steps)

```
(0,1,E0) -> (1,1,N2) -> (1,1,E3) -> (2,1,E4) -> (3,1,N5) -> (3,0,N2) -> (3,0,N7) -> (3,1,E8) -> (2,1,E9) -> (2,1,N10) -> (2,2,E8) -> (1,2,E9) -> (1,2,N10) -> (1,3,E8) -> (0,3,E9) -> (0,3,E11) -> (1,3,N15) -> (1,3,E16) -> (2,3,E17) -> (3,3,N18) -> (3,2,N15) -> (3,2,E16) -> (4,2,E17) -> (5,2,N18) -> (5,1,N15) -> (5,1,E16) -> (6,1,E17) -> (7,1,N18) -> (7,0,N15) -> (7,0,N20) -> (7,1,E21) -> (6,1,E22) -> (6,1,N23) -> (6,2,E21) -> (5,2,E22) -> (5,2,N23) -> (5,3,E21) -> (4,3,E22) -> (4,3,N23) -> (4,4,E21) -> (3,4,E22) -> (3,4,N23) -> (3,5,E21) -> (2,5,E22) -> (2,5,N23) -> (2,6,E21) -> (1,6,E22) -> (1,6,N23) -> (1,7,E21) -> (0,7,E22) -> (0,7,E24) -> (1,7,N27) -> (1,7,E28) -> (2,7,E29) -> (3,7,N30) -> (3,6,N27) -> (3,6,E28) -> (4,6,E29) -> (5,6,N30) -> (5,5,N27) -> (5,5,E28) -> (6,5,E29) -> (7,5,N30) -> (7,4,N27) -> (7,4,E28) -> (8,4,E29) -> (9,4,N30) -> (9,3,N27) -> (9,3,E28) -> (10,3,E29) -> (11,3,N30) -> (11,2,N27) -> (11,2,E28) -> (12,2,E29) -> (13,2,N30) -> (13,1,N27) -> (13,1,E28) -> (14,1,E29) -> (15,1,N30) -> (15,0,N27) -> (15,0,N32) -> (15,1,E33) -> (14,1,E34) -> (14,1,N35) -> (14,2,E33) -> (13,2,E34) -> (13,2,N35) -> (13,3,E33) -> (12,3,E34) -> (12,3,N35) -> (12,4,E33) -> (11,4,E34) -> (11,4,N35) -> (11,5,E33) -> (10,5,E34) -> (10,5,N35) -> (10,6,E33) -> (9,6,E34) -> (9,6,N35) -> (9,7,E33) -> (8,7,E34) -> (8,7,N35) -> (8,8,E33) -> (7,8,E34) -> (7,8,N35) -> (7,9,E33) -> (6,9,E34) -> (6,9,N35) -> (6,10,E33) -> (5,10,E34) -> (5,10,N35) -> (5,11,E33) -> (4,11,E34) -> (4,11,N35) -> (4,12,E33) -> (3,12,E34) -> (3,12,N35) -> (3,13,E33) -> (2,13,E34) -> (2,13,N35) -> (2,14,E33) -> (1,14,E34) -> (1,14,N35) -> (1,15,E33) -> (0,15,E34) -> (0,15,E36) -> (1,15,N39) -> (1,15,E40) -> (2,15,E41) -> (3,15,N42) -> (3,14,N39) -> (3,14,E40) -> (4,14,E41) -> (5,14,N42) -> (5,13,N39) -> (5,13,E40) -> (6,13,E41) -> (7,13,N42) -> (7,12,N39) -> (7,12,E40) -> (8,12,E41) -> (9,12,N42) -> (9,11,N39) -> (9,11,E40) -> (10,11,E41) -> (11,11,N42) -> (11,10,N39) -> (11,10,E40) -> (12,10,E41) -> (13,10,N42) -> (13,9,N39) -> (13,9,E40) -> (14,9,E41) -> (15,9,N42) -> (15,8,N39) -> (15,8,E40) -> (16,8,E41) -> (17,8,N42) -> (17,7,N39) -> (17,7,E40) -> (18,7,E41) -> (19,7,N42) -> (19,6,N39) -> (19,6,E40) -> (20,6,E41) -> (21,6,N42) -> (21,5,N39) -> (21,5,E40) -> (22,5,E41) -> (23,5,N42) -> (23,4,N39) -> (23,4,E40) -> (24,4,E41) -> (25,4,N42) -> (25,3,N39) -> (25,3,E40) -> (26,3,E41) -> (27,3,N42) -> (27,2,N39) -> (27,2,E40) -> (28,2,E41) -> (29,2,N42) -> (29,1,N39) -> (29,1,E40) -> (30,1,E41) -> (31,1,N42) -> (31,0,N39) -> (31,0,N44) -> (31,1,E45) -> (30,1,E46) -> (30,1,N47) -> (30,2,E45) -> (29,2,E46) -> (29,2,N47) -> (29,3,E45) -> (28,3,E46) -> (28,3,N47) -> (28,4,E45) -> (27,4,E46) -> (27,4,N47) -> (27,5,E45) -> (26,5,E46) -> (26,5,N47) -> (26,6,E45) -> (25,6,E46) -> (25,6,N47) -> (25,7,E45) -> (24,7,E46) -> (24,7,N47) -> (24,8,E45) -> (23,8,E46) -> (23,8,N47) -> (23,9,E45) -> (22,9,E46) -> (22,9,N47) -> (22,10,E45) -> (21,10,E46) -> (21,10,N47) -> (21,11,E45) -> (20,11,E46) -> (20,11,N47) -> (20,12,E45) -> (19,12,E46) -> (19,12,N47) -> (19,13,E45) -> (18,13,E46) -> (18,13,N47) -> (18,14,E45) -> (17,14,E46) -> (17,14,N47) -> (17,15,E45) -> (16,15,E46) -> (16,15,N47) -> (16,16,E45) -> (15,16,E46) -> (15,16,N47) -> (15,17,E45) -> (14,17,E46) -> (14,17,N47) -> (14,18,E45) -> (13,18,E46) -> (13,18,N47) -> (13,19,E45) -> (12,19,E46) -> (12,19,N47) -> (12,20,E45) -> (11,20,E46) -> (11,20,N47) -> (11,21,E45) -> (10,21,E46) -> (10,21,N47) -> (10,22,E45) -> (9,22,E46) -> (9,22,N47) -> (9,23,E45) -> (8,23,E46) -> (8,23,N47) -> (8,24,E45) -> (7,24,E46) -> (7,24,N47) -> (7,25,E45) -> (6,25,E46) -> (6,25,N47) -> (6,26,E45) -> (5,26,E46) -> (5,26,N47) -> (5,27,E45) -> (4,27,E46) -> (4,27,N47) -> (4,28,E45) -> (3,28,E46) -> (3,28,N47) -> (3,29,E45) -> (2,29,E46) -> (2,29,N47) -> (2,30,E45) -> (1,30,E46) -> (1,30,N47) -> (1,31,E45) -> (0,31,E46) -> (0,31,E48) -> (1,31,N51) -> (1,31,E52) -> (2,31,E53) -> (3,31,N54) -> (3,30,N51) -> (3,30,E52) -> (4,30,E53) -> (5,30,N54) -> (5,29,N51) -> (5,29,E52) -> (6,29,E53) -> (7,29,N54) -> (7,28,N51) -> (7,28,E52) -> (8,28,E53) -> (9,28,N54) -> (9,27,N51) -> (9,27,E52) -> (10,27,E53) -> (11,27,N54) -> (11,26,N51) -> (11,26,E52) -> (12,26,E53) -> (13,26,N54) -> (13,25,N51) -> (13,25,E52) -> (14,25,E53) -> (15,25,N54) -> (15,24,N51) -> (15,24,E52) -> (16,24,E53) -> (17,24,N54) -> (17,23,N51) -> (17,23,E52) -> (18,23,E53) -> (19,23,N54) -> (19,22,N51) -> (19,22,E52) -> (20,22,E53) -> (21,22,N54) -> (21,21,N51) -> (21,21,E52) -> (22,21,E53) -> (23,21,N54) -> (23,20,N51) -> (23,20,E52) -> (24,20,E53) -> (25,20,N54) -> (25,19,N51) -> (25,19,E52) -> (26,19,E53) -> (27,19,N54) -> (27,18,N51) -> (27,18,E52) -> (28,18,E53) -> (29,18,N54) -> (29,17,N51) -> (29,17,E52) -> (30,17,E53) -> (31,17,N54) -> (31,16,N51) -> (31,16,E52) -> (32,16,E53) -> (33,16,N54) -> (33,15,N51) -> (33,15,E52) -> (34,15,E53) -> (35,15,N54) -> (35,14,N51) -> (35,14,E52) -> (36,14,E53) -> (37,14,N54) -> (37,13,N51) -> (37,13,E52) -> (38,13,E53) -> (39,13,N54) -> (39,12,N51) -> (39,12,E52) -> (40,12,E53) -> (41,12,N54) -> (41,11,N51) -> (41,11,E52) -> (42,11,E53) -> (43,11,N54) -> (43,10,N51) -> (43,10,E52) -> (44,10,E53) -> (45,10,N54) -> (45,9,N51) -> (45,9,E52) -> (46,9,E53) -> (47,9,N54) -> (47,8,N51) -> (47,8,E52) -> (48,8,E53) -> (49,8,N54) -> (49,7,N51) -> (49,7,E52) -> (50,7,E53) -> (51,7,N54) -> (51,6,N51) -> (51,6,E52) -> (52,6,E53) -> (53,6,N54) -> (53,5,N51) -> (53,5,E52) -> (54,5,E53) -> (55,5,N54) -> (55,4,N51) -> (55,4,E52) -> (56,4,E53) -> (57,4,N54) -> (57,3,N51) -> (57,3,E52) -> (58,3,E53) -> (59,3,N54) -> (59,2,N51) -> (59,2,E52) -> (60,2,E53) -> (61,2,N54) -> (61,1,N51) -> (61,1,E52) -> (62,1,E53) -> (63,1,N54) -> (63,0,N51) -> (63,0,N56) -> (63,1,E57) -> (62,1,E58) -> (62,1,N59) -> (62,2,E57) -> (61,2,E58) -> (61,2,N59) -> (61,3,E57) -> (60,3,E58) -> (60,3,N59) -> (60,4,E57) -> (59,4,E58) -> (59,4,N59) -> (59,5,E57) -> (58,5,E58) -> (58,5,N59) -> (58,6,E57) -> (57,6,E58) -> (57,6,N59) -> (57,7,E57) -> (56,7,E58) -> (56,7,N59) -> (56,8,E57) -> (55,8,E58) -> (55,8,N59) -> (55,9,E57) -> (54,9,E58) -> (54,9,N59) -> (54,10,E57) -> (53,10,E58) -> (53,10,N59) -> (53,11,E57) -> (52,11,E58) -> (52,11,N59) -> (52,12,E57) -> (51,12,E58) -> (51,12,N59) -> (51,13,E57) -> (50,13,E58) -> (50,13,N59) -> (50,14,E57) -> (49,14,E58) -> (49,14,N59) -> (49,15,E57) -> (48,15,E58) -> (48,15,N59) -> (48,16,E57) -> (47,16,E58) -> (47,16,N59) -> (47,17,E57) -> (46,17,E58) -> (46,17,N59) -> (46,18,E57) -> (45,18,E58) -> (45,18,N59) -> (45,19,E57) -> (44,19,E58) -> (44,19,N59) -> (44,20,E57) -> (43,20,E58) -> (43,20,N59) -> (43,21,E57) -> (42,21,E58) -> (42,21,N59) -> (42,22,E57) -> (41,22,E58) -> (41,22,N59) -> (41,23,E57) -> (40,23,E58) -> (40,23,N59) -> (40,24,E57) -> (39,24,E58) -> (39,24,N59) -> (39,25,E57) -> (38,25,E58) -> (38,25,N59) -> (38,26,E57) -> (37,26,E58) -> (37,26,N59) -> (37,27,E57) -> (36,27,E58) -> (36,27,N59) -> (36,28,E57) -> (35,28,E58) -> (35,28,N59) -> (35,29,E57) -> (34,29,E58) -> (34,29,N59) -> (34,30,E57) -> (33,30,E58) -> (33,30,N59) -> (33,31,E57) -> (32,31,E58) -> (32,31,N59) -> (32,32,E57) -> (31,32,E58) -> (31,32,N59) -> (31,33,E57) -> (30,33,E58) -> (30,33,N59) -> (30,34,E57) -> (29,34,E58) -> (29,34,N59) -> (29,35,E57) -> (28,35,E58) -> (28,35,N59) -> (28,36,E57) -> (27,36,E58) -> (27,36,N59) -> (27,37,E57) -> (26,37,E58) -> (26,37,N59) -> (26,38,E57) -> (25,38,E58) -> (25,38,N59) -> (25,39,E57) -> (24,39,E58) -> (24,39,N59) -> (24,40,E57) -> (23,40,E58) -> (23,40,N59) -> (23,41,E57) -> (22,41,E58) -> (22,41,N59) -> (22,42,E57) -> (21,42,E58) -> (21,42,N59) -> (21,43,E57) -> (20,43,E58) -> (20,43,N59) -> (20,44,E57) -> (19,44,E58) -> (19,44,N59) -> (19,45,E57) -> (18,45,E58) -> (18,45,N59) -> (18,46,E57) -> (17,46,E58) -> (17,46,N59) -> (17,47,E57) -> (16,47,E58) -> (16,47,N59) -> (16,48,E57) -> (15,48,E58) -> (15,48,N59) -> (15,49,E57) -> (14,49,E58) -> (14,49,N59) -> (14,50,E57) -> (13,50,E58) -> (13,50,N59) -> (13,51,E57) -> (12,51,E58) -> (12,51,N59) -> (12,52,E57) -> (11,52,E58) -> (11,52,N59) -> (11,53,E57) -> (10,53,E58) -> (10,53,N59) -> (10,54,E57) -> (9,54,E58) -> (9,54,N59) -> (9,55,E57) -> (8,55,E58) -> (8,55,N59) -> (8,56,E57) -> (7,56,E58) -> (7,56,N59) -> (7,57,E57) -> (6,57,E58) -> (6,57,N59) -> (6,58,E57) -> (5,58,E58) -> (5,58,N59) -> (5,59,E57) -> (4,59,E58) -> (4,59,N59) -> (4,60,E57) -> (3,60,E58) -> (3,60,N59) -> (3,61,E57) -> (2,61,E58) -> (2,61,N59) -> (2,62,E57) -> (1,62,E58) -> (1,62,N59) -> (1,63,E57) -> (0,63,E58) -> (0,63,E60) -> (1,63,N12) -> (1,62,N12) -> (1,61,N12) -> (1,60,N12) -> (1,59,N12) -> (1,58,N12) -> (1,57,N12) -> (1,56,N12) -> (1,55,N12) -> (1,54,N12) -> (1,53,N12) -> (1,52,N12) -> (1,51,N12) -> (1,50,N12) -> (1,49,N12) -> (1,48,N12) -> (1,47,N12) -> (1,46,N12) -> (1,45,N12) -> (1,44,N12) -> (1,43,N12) -> (1,42,N12) -> (1,41,N12) -> (1,40,N12) -> (1,39,N12) -> (1,38,N12) -> (1,37,N12) -> (1,36,N12) -> (1,35,N12) -> (1,34,N12) -> (1,33,N12) -> (1,32,N12) -> (1,31,N12) -> (1,30,N12) -> (1,29,N12) -> (1,28,N12) -> (1,27,N12) -> (1,26,N12) -> (1,25,N12) -> (1,24,N12) -> (1,23,N12) -> (1,22,N12) -> (1,21,N12) -> (1,20,N12) -> (1,19,N12) -> (1,18,N12) -> (1,17,N12) -> (1,16,N12) -> (1,15,N12) -> (1,14,N12) -> (1,13,N12) -> (1,12,N12) -> (1,11,N12) -> (1,10,N12) -> (1,9,N12) -> (1,8,N12) -> (1,7,N12) -> (1,6,N12) -> (1,5,N12) -> (1,4,N12) -> (1,3,N12) -> (1,2,N12) -> (1,1,N12) -> (1,0,N12) -> (1,0,N13) -> (1,1,E14) -> (0,1,E1)
```
